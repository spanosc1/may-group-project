<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Material Design Bootstrap Template</title>

  <!-- Material Design Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

  <!-- Bootstrap core CSS -->
  <link href="css/bootstrap.min.css" rel="stylesheet">

  <!-- Material Design Bootstrap -->
  <link href="css/mdb.css" rel="stylesheet">

  <!-- Template style -->
  <link href="css/style.css" rel="stylesheet">
  
  <title>Group Project</title>

</head>

    
  <body>
   
  <!-- Navigation -->
  <nav class="navbar z-depth-2 info-color">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand waves-effect waves-light" href="#">Our Group Project</a>
      </div>

      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav navbar-right">
          <!--- previously linked to /planner /recipepicker/1--->
          <!--- temporarily testing the recipepicker endpoint -->
          <li><a href="/planner/1/05-20-2016" class="waves-effect waves-light">Meal Planner Page<span class="sr-only">(current)</span></a>
          </li>
          <li><a href="/" class="waves-effect waves-light">Recipe Search Page<span class="sr-only">(current)</span></a></li>
          <li><a href="#" class="wave-effect waves-light" id="loginStatus">Not Logged In<span class="sr-only">(current)</span></a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Tabbed content: see http://getbootstrap.com/javascript/#tabs -->

  <div class="container">
  
  <div class="row">
  <div class="col-xs-12 panel panel-body z-depth-2">

  <!-- Nav tabs -->
  <ul class="nav nav-tabs" role="tablist" id="myTab">
    <li role="presentation" class="active"><a href="#recipelist" aria-controls="home" role="tab" data-toggle="tab">My Recipes</a></li>
    <li role="presentation"><a href="#schedule" aria-controls="profile" role="tab" data-toggle="tab">Weekly Planner</a></li>
  </ul>

  <!-- Tab panes -->
  
  <div class="tab-content">
    <div role="tabpanel" class="tab-pane active" id="recipelist">
    	<br>
    	<p> Stored Recipes </p>
      <div class="row">
          <div class="shopHere"></div>
      </div>
    </div>

    <div role="tabpanel" class="tab-pane" id="schedule">
    	<br>
      
        <div class="eatThese"></div>

    </div> <!-- end of this tab panel -->
  </div> <!-- end of tab content div -->
  </div> <!-- col-xs-12 end -->
  </div> <!-- row end -->
  </div> <!-- container end -->
  
  <!-- Footer -->
  <footer class="page-footer info-color darken-1" if="footer">
    <div class="container">
      <div class="row">
        <div class="col-md-3 col-md-offset-1">
          <p class="white-text center-on-small-only">GET STARTED</p>
          <p class="white-text center-on-small-only">Register for free and start to create amazing things.</p>
          <a href="http://mdbootstrap.com/getting-started/" class="btn btn-danger waves-effect waves-light">Get started!</a>

        </div>
        <hr class="hidden-lg hidden-md">

        <div class="col-md-2">
          <p class="white-text center-on-small-only">USEFUL LINKS</p>
          <ul>
            <li><a href="#" data-toggle="modal" data-target="#myModal" class="grey-text text-lighten-3" href="#!">Contact us</a>
            </li>
            <li><a class="grey-text text-lighten-3" href="http://mdbootstrap.com/material-design-for-bootstrap/" target="_blank">About MDB</a>
            </li>
            <li><a class="grey-text text-lighten-3" href="http://mdbootstrap.com/forums/forum/support/" target="_blank">Support</a>
            </li>
            <li><a class="grey-text text-lighten-3" href="http://mdbootstrap.com/forums/forum/bugs/" target="_blank">Bug report</a>
            </li>


          </ul>
        </div>
        <hr class="hidden-lg hidden-md">
        
        <div class="col-md-3 text-center">
          <p class="white-text text-center"> SOCIAL MEDIA</p>
          <a target="_blank" href="https://www.facebook.com/mdbootstrap" class="btn-floating btn-large fb-bg waves-effect waves-light"><i class="fa fa-facebook"> </i></a>
          <a target="_blank" href="https://twitter.com/MDBootstrap" class="btn-floating btn-large tw-bg waves-effect waves-light"><i class="fa fa-twitter"> </i></a>
          <a target="_blank" href="https://plus.google.com/u/0/b/107863090883699620484/107863090883699620484/posts" class="btn-floating btn-large gplus-bg waves-effect waves-light"><i class="fa fa-google-plus"> </i></a>
        </div>

      </div>
    </div>
    <div class="footer-copyright wow">
      <div class="container">
        <div class="col-md-10 col-md-offset-1"> Â© 2016 Copyright <a href="http://github.com/jagross66/group-project-2" target="_blank">Chris, Dhaval, James, Jeremy</a>
        </div>
      </div>
    </div>
  </footer>
 

 <script type="text/javascript" src="js/jquery.min.js"></script>
 <script type="text/javascript" src="js/bootstrap.min.js"></script>
 
 
 <script>

  // Activates tabs on click
 
  $('#myTab a').click(function(e) {
    e.preventDefault();
    $(this).tab('show');
  });

  
  populateShoplist();
  populatePlan();
  

  function populateShoplist(){
    
   var userId = 1; // for testing ONLY
  
  $.get("/getshoplist/"+userId, function(gotBack){
     
    var listBuy;
     

    for (i in gotBack){
    
    var costAddup = 0;

       if (gotBack[i].listtobuy)
      {
        listBuy = gotBack[i].listtobuy.split(",");
      } else continue;

      var outerHtml = "<div class='col-xs-4'><div class='card hoverable'><div class='card-content'>";
      var text ="<h3>"+ gotBack[i].recipetitle+"</h3><br>";

      for (ii=0; ii < listBuy.length; ii++){

        if (listBuy[ii].indexOf("~" != -1)){
          tildeSplit = listBuy[ii].split("~");
        } else continue;

        text += "<li>"+tildeSplit[0]+" : $"+tildeSplit[1]+"</li>";
        if (typeof tildeSplit[1] != "string"){
          tildeSplit[1] = 0;
        }
        costAddup += Number(tildeSplit[1]);

      }

      var closingTags = "</div></div>";
      var costTotal = "<br>- - - - -<br><p>Total Cost: "+costAddup+"</p>";

      $(".shopHere").append(outerHtml+text+costTotal+closingTags);
      
    }


  });

  }

  // populate planner tab with meal info for user

  function populatePlan(){

  var userId = sessionStorage.userId;
  // for testing purposes

  var startDate = "5-23-2016";
  

  $.get("/planner/"+userId+"/"+startDate, function(response){

// iterate over each position in array of objects, ie, each
// row in the table matching date and user id
    var gotBack = response;
     

    for (i in gotBack){
      var outerHtml = "<div class='col-xs-4'><div class='card hoverable'><div class='card-content'>";
      var text ="<h3>"+ gotBack[i].recipe_name+"</h3><br><h5>Designated Date: "+gotBack[i].date+"</h5><br>";
      var closingTags = "</div></div>";
      $(".eatThese").append(outerHtml+text+closingTags);
    }


  });



 }
 

</script>

</body>
